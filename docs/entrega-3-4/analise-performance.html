<!doctype html>
<html>
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1,user-scalable=no">
<meta name="description" content="undefined - microjam page">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js/styles/vs.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex/dist/katex.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/markdown-it-texmath/css/texmath.min.css">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/goessner/mdmath/themes/publication/style.css">

<title>undefined</title>
</head>
<body id="top">
<header>






</header>
<main>
<span id="markdown-mermaid" aria-hidden="true"
                    data-dark-mode-theme="dark"
                    data-light-mode-theme="default"></span>
                <h2 dir="auto" id="an%C3%A1lise-de-performance">Análise de Performance</h2>
<h3 dir="auto" id="introdu%C3%A7%C3%A3o">Introdução</h3>
<p dir="auto">Neste documento é apresentada a análise de performance da plataforma Testify. Antes de apresentar os resultados, introduzirei os conceitos de um teste de performance.</p>
<p dir="auto">De acordo com a <a href="https://iso25000.com/index.php/en/iso-25000-standards/iso-25010">ISO/IEC 25010</a>, a performance de um software é uma característica de qualidade, que é relativa a quantidade de recursos utilizados por um software para realizar uma determinada função. Ela possui as seguintes subcaracterísticas: tempo de resposta, utilização de recursos e capacidade.</p>
<p dir="auto">Um teste de performance é um tipo de teste de software que tem como objetivo avaliar a performance de um software. Teste de performance é um termo bastante abrangente, e possui diferentes estratégias e objetivos. Nesta etapa do trabalho, pretendo executar um teste de carga nos componentes backend da plataforma Testify, com o objetivo de avaliar a capacidade de suportar um grande volume de acessos simultâneos.</p>
<h3 dir="auto" id="recursos-utilizados">Recursos utilizados</h3>
<p dir="auto">Os testes foram executados em um computador com a configuração abaixo:</p>
<table dir="auto">
<thead dir="auto">
<tr dir="auto">
<th>Componente</th>
<th>Especificação</th>
</tr>
</thead>
<tbody dir="auto">
<tr dir="auto">
<td>Processador</td>
<td>Intel Core i7 de 6 núcleos de 9ª geração</td>
</tr>
<tr dir="auto">
<td>Velocidade do processador</td>
<td>2,6GHz base, até 4,5GHz com Turbo Boost</td>
</tr>
<tr dir="auto">
<td>Memória RAM</td>
<td>16GB DDR4</td>
</tr>
<tr dir="auto">
<td>Armazenamento</td>
<td>512GB SSD</td>
</tr>
<tr dir="auto">
<td>Sistema operacional</td>
<td>macOS 12.6 (Monterey)</td>
</tr>
</tbody>
</table>
<p dir="auto">Os dois componentes testados foram o Runner e o Exercises. Os dois foram executados com Python 3.10.8.
A versão do Docker utilizada pelo Runner foi a 23.0.5. O Docker foi configurado para utilizar até 6 CPUs e até 2GB de memória RAM.</p>
<p dir="auto">A análise de performance foi feita utilizando o <a href="https://jmeter.apache.org/">JMeter</a>, uma ferramenta de código aberto para análise de desempenho de aplicações web.</p>
<h3 dir="auto" id="an%C3%A1lise-de-desempenho-do-componente-runner-utilizando-o-jmeter">Análise de desempenho do componente Runner utilizando o JMeter</h3>
<p dir="auto">Abaixo é apresentado o resultado da análise de desempenho do componente Runner utilizando o JMeter. O JMeter foi configurado para simular 30 usuários acessando a plataforma Testify ao mesmo tempo, com 10 repetições.</p>
<table dir="auto">
<thead dir="auto">
<tr dir="auto">
<th>Label</th>
<th>#Samples</th>
<th>FAIL</th>
<th>Error %</th>
<th>Average (ms)</th>
<th>Min (ms)</th>
<th>Max (ms)</th>
<th>Median (ms)</th>
<th>Transactions/s</th>
</tr>
</thead>
<tbody dir="auto">
<tr dir="auto">
<td>Total</td>
<td>300</td>
<td>49</td>
<td>16.33%</td>
<td>21323.37</td>
<td>2567</td>
<td>26168</td>
<td>21973.50</td>
<td>1.32</td>
</tr>
<tr dir="auto">
<td>HTTP Request</td>
<td>300</td>
<td>49</td>
<td>16.33%</td>
<td>21323.37</td>
<td>2567</td>
<td>26168</td>
<td>21973.50</td>
<td>1.32</td>
</tr>
</tbody>
</table>
<p dir="auto">Como apresentado na tabela acima, 16.33% das requisições falharam. As falhas apresentadas foram devido a um problema de concorrencia na criação de arquivos temporários.
Em detalhe, o problema ocorre quando dois enviam testes para um mesmo exercício. Cada teste enviado é salvo em um arquivo temporário, e os nomes desses arquivos são pré-definidos pela configuração do teste. Quando dois usuários enviam testes para um mesmo exercício, os nomes dos arquivos temporários são iguais, e o segundo usuário a enviar o teste sobrescreve o arquivo temporário do primeiro usuário. Para resolver este problema, é necessário que o nome dos arquivos temporários sejam gerados de forma aleatória, ou que o envio de testes seja feito de forma sequencial.</p>
<h4 dir="auto" id="ajustes-e-resultados-obtidos">Ajustes e resultados obtidos</h4>
<p dir="auto">Para resolver o problema de concorrência na criação de arquivos temporários, foi feita uma alteração no código fonte do componente Runner. O nome dos arquivos temporários passou a ser gerado dentro de uma pasta com nome aleatório. Com esta alteração, o problema de concorrência foi resolvido, e o número de falhas foi reduzido para 0%.</p>
<p dir="auto">Duas mudanças foram enviadas para o projeto original do componente Runner:</p>
<ol dir="auto">
<li dir="auto"><a href="https://github.com/testify-tcc/runner/pull/2">Alteração no código fonte para gerar nomes de arquivos temporários de forma aleatória</a></li>
<li dir="auto"><a href="https://github.com/testify-tcc/runner/pull/1">Correção nos testes unitários para garantir que a mudança não altere o comportamento do componente</a></li>
</ol>
<p dir="auto">As mudanças ainda aguardam aprovação do mantenedor do projeto.</p>
<p dir="auto">A tabela abaixo apresenta os resultados obtidos após a correção do problema de concorrência na criação de arquivos temporários.</p>
<table dir="auto">
<thead dir="auto">
<tr dir="auto">
<th>Label</th>
<th>#Samples</th>
<th>FAIL</th>
<th>Error %</th>
<th>Average (ms)</th>
<th>Min (ms)</th>
<th>Max (ms)</th>
<th>Median (ms)</th>
<th>Transactions/s</th>
</tr>
</thead>
<tbody dir="auto">
<tr dir="auto">
<td>Total</td>
<td>300</td>
<td>0</td>
<td>0.00%</td>
<td>24917.62</td>
<td>15197</td>
<td>30460</td>
<td>25689.00</td>
<td>1.14</td>
</tr>
<tr dir="auto">
<td>HTTP Request</td>
<td>300</td>
<td>0</td>
<td>0.00%</td>
<td>24917.62</td>
<td>15197</td>
<td>30460</td>
<td>25689.00</td>
<td>1.14</td>
</tr>
</tbody>
</table>
<p dir="auto">Como é possível notar, a mudança no código fonte do componente Runner não alterou consideralvemente desempenho do componente. Uma pequena mudança no tempo médio das requisições foi observada, e possivelmente é relacionada com a carga adicional que o componente passou a processar dado que não havia falha de execução de testes.</p>
<h3 dir="auto" id="an%C3%A1lise-de-desempenho-do-componente-exercises-utilizando-o-jmeter">Análise de desempenho do componente Exercises utilizando o JMeter</h3>
<p dir="auto">Abaixo é apresentado o resultado da análise de desempenho do componente Exercises utilizando o JMeter. O JMeter foi configurado para simular 200 usuários acessando a plataforma Testify ao mesmo tempo, com 50 repetições, e um tempo limite de 120 segundos.</p>
<table dir="auto">
<thead dir="auto">
<tr dir="auto">
<th>Label</th>
<th style="text-align:right">#Samples</th>
<th style="text-align:right">FAIL</th>
<th style="text-align:right">Error %</th>
<th style="text-align:right">Average (ms)</th>
<th style="text-align:right">Min (ms)</th>
<th style="text-align:right">Max (ms)</th>
<th style="text-align:right">Median (ms)</th>
<th style="text-align:right">Transactions/s</th>
</tr>
</thead>
<tbody dir="auto">
<tr dir="auto">
<td>Total</td>
<td style="text-align:right">2500</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0.00%</td>
<td style="text-align:right">183.67</td>
<td style="text-align:right">8</td>
<td style="text-align:right">398</td>
<td style="text-align:right">193.00</td>
<td style="text-align:right">29800.78</td>
</tr>
<tr dir="auto">
<td>HTTP Request</td>
<td style="text-align:right">2500</td>
<td style="text-align:right">0</td>
<td style="text-align:right">0.00%</td>
<td style="text-align:right">183.67</td>
<td style="text-align:right">8</td>
<td style="text-align:right">398</td>
<td style="text-align:right">193.00</td>
<td style="text-align:right">29800.78</td>
</tr>
</tbody>
</table>
<p dir="auto">Como é possível notar, o componente Exercises não apresentou falhas de execução de testes. A carga de usuários acessando simultaneamente a aplicação é consideravelmente maior do que o componente Runner. Isto ocorre porque a requisição executada não demanda de recursos externos.</p>
<h3 dir="auto" id="considera%C3%A7%C3%B5es-finais">Considerações finais</h3>
<p dir="auto">Após a análise inicial e correções pontuais, foi possível verificar que o componente agora pode ser utilizado em produção pode diversos usuários. O componente Runner, quando utilizado com carga de concorrência considerável apresenta lentidão que pode comprometer a experiência do usuário. O componente Exercises, por outro lado, apresentou bom desempenho mesmo com carga de concorrência alta. Os testes foram executados com recursos superdimensionados, e portanto, é possível que o desempenho do componente seja menor quando utilizado em produção.</p>
<p dir="auto">Nas próximas entregas serão executados testes de resistência com cargas e recursos mais próximos da realidade. Estes testes serão executados em um ambiente virtualizado ou em um ambiente em núvem pública.</p>

</main>
</body>
</html>